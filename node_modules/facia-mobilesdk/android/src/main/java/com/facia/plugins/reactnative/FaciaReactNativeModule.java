package com.facia.plugins.reactnative;

import com.facebook.react.bridge.*;
import com.facebook.react.modules.core.*;



import org.jetbrains.annotations.*;

import android.util.Log;
import com.facia.faciasdk.FaciaAi;

import org.json.JSONObject;

import androidx.annotation.NonNull;

public class FaciaReactNativeModule extends ReactContextBaseJavaModule {

    private final ReactApplicationContext reactContext;
    

    private final static String LOG_TAG = "FaciaModule";


    public FaciaReactNativeModule(@NonNull ReactApplicationContext reactContext) {
        super(reactContext);
        this.reactContext = reactContext;
    } 

    @ReactMethod
    public void testMethod() {
        Log.d(LOG_TAG,LOG_TAG+ " testing++");
    }

    @ReactMethod
    public void verify(String token,String configObject, Callback callback) {
        try {

               JSONObject configJson = new JSONObject(configObject);
               configJson.put("appInfo", "react-native-0.5.9");

               FaciaAi faciaAi = new FaciaAi();

               faciaAi.createRequest(token,getCurrentActivity(), configJson, responseSet -> {
            
                        callback.invoke(new JSONObject(responseSet).toString());
                    
                });

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
   

    @NonNull
    @Override
    public String getName() {
        return "FaciaReactNativeModule";
    }
}
